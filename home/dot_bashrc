#!/usr/bin/env bash

# `bashrc` is the individual per-interactive-shell startup file.

# @url https://unix.stackexchange.com/questions/104755/how-can-i-create-a-local-function-in-my-bashrc
# Delete functions that should not exceed this bashrc's scope.
_cleanup() {
  unset -f _cleanup
  unset -f _extend_path
  unset -f _is_running_interactively
  unset -f _main
  unset -f _set_bash_history
  unset -f _set_system_defaults
}

# Potentially extend the `PATH` variable.
_extend_path() {
  declare -r -a paths=(
    "$HOME/.bin"         
    "$HOME/.local/bin"
    "$HOME/p/applications"
  )

  for path in "${paths[@]}"; do
    [[ -d "$path" ]] && PATH="$path:$PATH"
  done 
}

# Returns true if the current shell is running interactively, and false
# otherwise.
_is_running_interactively() {
  [[ $- != *i* ]]
}

# Set bash history related variables.
_set_bash_history() {
  # Bash history does not contain duplicate lines or lines beginning with a
  # space.
  export HISTCONTROL=erasedups:ignoredups:ignorespace

  # Expand the bash history size.
  export HISTFILESIZE=10000
  export HISTSIZE=500
}

# Set system defaults.
_set_system_defaults() {
  # Set default terminal.
  export TERM="alacritty"

  # Set default text editor.
  export EDITOR="nvim"
  export VISUAL="nvim"
}

_main() {
  _set_system_defaults
  _is_running_interactively && return
  _set_bash_history
  _extend_path
}

_main
_cleanup
